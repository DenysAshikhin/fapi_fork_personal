"use strict";(self.webpackChunkfapi=self.webpackChunkfapi||[]).push([[133],{2133:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e){var o=function(e,o){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,o||"default");if("object"!==t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(e)}(e,"string");return"symbol"===t(o)?o:String(o)}function o(t,o,r){return(o=e(o))in t?Object.defineProperty(t,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[o]=r,t}function r(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function n(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,r=new Array(e);o<e;o++)r[o]=t[o];return r}function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"===typeof t)return a(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s={roundTwoDecimal:function(t){return Math.round(100*(t+Number.EPSILON))/100},roundThreeDecimal:function(t){return Math.round(1e3*(t+Number.EPSILON))/1e3},roundInt:function(t){return Math.round(1*(t+Number.EPSILON))/1},calculateLogarithm:function(t,e){return Math.log(e)/Math.log(t)},calcPOW:function(t){return t.mantissa*Math.pow(10,t.exponent)},secondsToStringWithS:function(t){var e,o,r,n="";return e=Math.floor(t/3600),o=Math.floor(t%3600/60),r=this.roundInt(t%3600%60),e>0&&(n+="".concat(e<10?"0"+e:e,"h:")),o>0&&(n+="".concat(o<10?"0"+o:o,"m:")),n+=r>0?"".concat(r<10?"0"+r:r,"s"):"0s"},secondsToString:function(t){var e,o,r="";return e=Math.floor(t/3600),o=this.roundInt(t%3600/60),e>0&&(r+="".concat(e<10?"0"+e:e,"h:")),r+=o>0?"".concat(o<10?"0"+o:o,"m"):"0s"},bonusColorMap:{1001:{color:"maroon"},1002:{color:"orange"},1003:{color:"purple"},1009:{color:"cyan"},1012:{color:"yellow"},1013:{color:"red"},1014:{color:"blue"},1015:{color:"gray"},1016:{color:"green"}}},l={findMultipliersWithMinPercentage:function(t,e,o){var r=[],n=0;return function a(s,l,c){if(n++,s!==e.length)for(var u=Math.floor((t-l)/e[s]),p=0;p<=u;p++){c[s]=p,l+p*e[s]<t&&a(s+1,l+p*e[s],c)}else{var m=c.reduce((function(t,o,r){return t+o*e[r]}),0);m>=o*t&&r.push(i(c))}}(0,0,[]),console.log(n),r},calcGrowthTime:function(t,e){var o=Math.floor(t.TimeNeeded/t.prestigeBonus/(1+.05*e.shopGrowingSpeed)/e.petPlantCombo/e.contagionPlantGrowth);return o<10?10:o},calcPlantHarvest:function(t,e){return s.roundInt((1+t.Rank)*Math.pow(1.05,t.Rank))*Math.pow(1.02,t.prestige)*e.contagionHarvest},calcProdOutput:function(t,e){var o=t.totalMade,r=t.created,n=e.manualHarvestFormula,a=e.shopProdBonus,i=t.prestige,l=1*a*1*e.contagionPlantProd,c=o*Math.pow(1+.05*(1+.02*n),s.calculateLogarithm(1.25,r))*l*Math.pow(1.02,i);return 1===t.ID&&(c*=e.hpBonus),c},calcFryOutput:function(t){return(s.calculateLogarithm(10,t)-15.75)*(20-Math.min(s.calculateLogarithm(10,t),31)+16)*Math.pow(1.15,s.calculateLogarithm(10,t)-16)},calcCarryOverEXP:function(t){var e=t.plant,o=t.numAutos,r=t.expTick,n=0,a=1;if(o>1){var i=r/o,s=Math.ceil((e.reqExp-e.curExp)/i);if(o>s){n=(o-s)*i;for(var l=10+5*(e.Rank+a)*Math.pow(1.05,e.Rank+a);n>l;)n-=l,a++,l=10+5*(e.Rank+a)*Math.pow(1.05,e.Rank+a)}else n=0}else n=0;return{leftOver:n,numLevels:a}},calcFutureMult:function(t,e){var o=!1===e.string?t:JSON.parse(JSON.stringify(t)),r=!1===e.string?e:JSON.parse(JSON.stringify(e)),n=r.time,a=r.numAuto||0===(null===r||void 0===r?void 0:r.numAuto)?r.numAuto:1,i=o.prestigeBonus*r.expBonus*a;for(o.growthTime=Math.floor(o.TimeNeeded/o.prestigeBonus/(1+.05*r.shopGrowingSpeed)/r.petPlantCombo/r.contagionPlantGrowth),o.growthTime<10&&(o.growthTime=10);n>0;){if(o.timeToLevel=Math.ceil((o.reqExp-o.curExp)/i)*o.growthTime,1===o.ID);var l=0,c=!1;o.timeToLevel>=n?l=n:(l=o.timeToLevel,c=!0),n-=l,o.elapsedTime+=l;var u=0;if(o.elapsedTime>=o.growthTime){u=Math.floor(o.elapsedTime/o.growthTime);var p=o.perHarvest*u*a;if(o.created+=p,o.totalMade+=p,o.futureMult=Math.pow(1+.05*(1+.02*r.manualHarvestFormula),s.calculateLogarithm(1.25,o.created)),c){var m=this.calcCarryOverEXP({plant:o,expTick:i,numAutos:a});o.curExp=m.leftOver,o.Rank+=m.numLevels,o.perHarvest=this.calcPlantHarvest(o,r),o.reqExp=10+5*o.Rank*Math.pow(1.05,o.Rank)}else{var h=u*i,f=o.curExp+h;if(f>o.reqExp){var d=this.calcCarryOverEXP({plant:o,expTick:i,numAutos:a});o.curExp=d.leftOver,o.Rank+=d.numLevels,o.perHarvest=this.calcPlantHarvest(o,r),o.reqExp=10+5*o.Rank*Math.pow(1.05,o.Rank)}else o.curExp=f}o.elapsedTime=o.elapsedTime%o.growthTime}var g=this.calcProdOutput(o,r);o.production=g}return o},calcTimeTillLevel:function(t,e){var o=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(e)),n=r.numAuto||0===(null===r||void 0===r?void 0:r.numAuto)?r.numAuto:1;o.growthTime=Math.floor(o.TimeNeeded/o.prestigeBonus/(1+.05*r.shopGrowingSpeed)/r.petPlantCombo/r.contagionPlantGrowth),o.growthTime<10&&(o.growthTime=10),o.reqExp=10+5*o.Rank*Math.pow(1.05,o.Rank);var a=o.reqExp-o.curExp,i=o.prestigeBonus*r.expBonus*n,s=Math.ceil(a/i);return o.timeToLevel=s*o.growthTime,o},getNextShopCosts:function(t){var e=t.FarmingShopPlantTotalProduction?t.FarmingShopPlantTotalProduction:t.shopProdLevel,o=t.FarmingShopPlantGrowingSpeed?t.FarmingShopPlantGrowingSpeed:t.shopGrowingSpeed,r=t.FarmingShopPlantRankExpEarned?t.FarmingShopPlantRankExpEarned:t.shopRankLevel;return{prodCost:e>50?1e8*Math.pow(100*Math.pow(1.05,e-50),e):1e8*Math.pow(100,e),growthCost:1e10*Math.pow(500,o),expCost:1e15*Math.pow(250,r)}},calcMaxPrestige:function(t){for(var e=t.prestige,o=0,r=!0;r;){var n=o+10*Math.pow(2,e);t.created>=n?(e++,o+=n):r=!1}return e-t.prestige},calcTimeTillPrestige:function(t,e){for(var o=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(e)),n=r.numAuto||0===(null===r||void 0===r?void 0:r.numAuto)?r.numAuto:1,a=!1,i=0,s=0;!a;){var l=this.calcTimeTillLevel(o,r).timeToLevel,c=s+10*Math.pow(2,o.prestige),u=c-o.created,p=Math.ceil(u/(o.perHarvest*n))*o.growthTime;if(p<=0)a=!0,i<=0&&(o.prestige++,a=!1,s+=c);else if(p>l){o.elapsedTime+=l;var m=Math.floor(o.elapsedTime/o.growthTime);o.created+=m*o.perHarvest*n,o.totalMade+=m*o.perHarvest*n,o.Rank++,o.curExp=0,o.perHarvest=this.calcPlantHarvest(o,r),i+=l,o.elapsedTime=o.elapsedTime%o.growthTime}else{a=!0,o.elapsedTime+=p;var h=Math.floor(o.elapsedTime/o.growthTime);o.created+=h*o.perHarvest*n,o.totalMade+=h*o.perHarvest*n,i+=p,o.elapsedTime=o.elapsedTime%o.growthTime}}return{remainingTime:i,prestige:o.prestige,prestiged:a}},calcHPProd:function(t,e){for(var o=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(e)),a=r.numAutos,i=r.time,c=r.startTime?r.startTime:0,u=r.runningTime?r.runningTime:0,p=r.maxSteps?r.maxSteps:100,m=r.tickStart?r.tickStart:0,h=r.tickRate?r.tickRate:60,f=r.dataPointThreshold?r.dataPointThreshold:i/h<p?1:s.roundInt(i/h/p),d=[],g=[],v=r.totalPotatoes,P=r.curPotatoes,b=Array(o.length).fill(0),S=0;S<o.length;S++)b[S]=o[S].production;for(var w=0,y=!1;w<i/h||y;w++){for(var T=o.length-1;T>=0;T--){var M=o[T],O=T===o.length-1?0:h>1?.5*(b[T+1]+o[T+1].production)*h:o[T+1].production*h;M.totalMade+=O;var C=this.calcFutureMult(M,n(n({},r),{},{time:h,numAuto:a[T],string:!1}));o[T]=C,b[T]=o[T].production}var x=s.roundInt(w*h+c);if(v+=o[0].production*h,P+=o[0].production*h,r.autoBuyPBC){var k=!1;if(P>=r.nextCosts.prodCost&&(P-=r.nextCosts.prodCost,r.shopProdLevel++,r.shopProdBonus=Math.pow(1.25,r.shopProdLevel),k=!0),P>=r.nextCosts.growthCost&&(P-=r.nextCosts.growthCost,r.shopGrowingSpeed++,k=!0),P>=r.nextCosts.expCost&&(P-=r.nextCosts.expCost,r.shopRankLevel++,r.shopRankEXP=1+.1*r.shopRankLevel,k=!0),k){var L=this.getNextShopCosts(r);r.nextCosts=L}}if(w%f===0&&x>=m&&x<=i+u&&(d.push({time:x,production:v}),g.push({time:x,fries:l.calcFryOutput(v)})),!r.skipFinal){if(y&&x>=i+u)break;!y&&x<i+u&&(y=!0)}}if(w>0&&!r.skipFinal){var E=s.roundInt(w*h+c);if(0===d.length){if(E>i+u);d.push({time:E,production:v}),g.push({time:E,fries:l.calcFryOutput(v)})}else if(d[d.length-1].production!==v&&E>i+u){var A=E-d[d.length-1].time,N=(v-d[d.length-1].production)/A,H=i+u-d[d.length-1].time,B=d[d.length-1].production+N*H,R={time:d[d.length-1].time+H,production:B};d.push(R),g.push({time:d[d.length-1].time+H,fries:l.calcFryOutput(d[d.length-1].production+N*H)}),v=B}}return{totalPotatoes:v,potatoeProduction:o[0].production,plants:o,nextCosts:r.nextCosts,dataPointsPotatoes:d,dataPointsFries:g,finalModifiers:r}},calcStepHPProd:function(t,e){for(var o=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(e)),a=r.steps,i=-1,l=[],c=0,u=r.maxSteps?r.maxSteps:100,p=r.tickRate?r.tickRate:60,m=e.time/p<u?1:s.roundInt(e.time/p/u),h=0;h<a.length;h++){if(l.length>0&&a[h].time>0);(r=(i=this.calcHPProd(o,n(n({},r),{},{numAutos:a[h].autos,time:a[h].time,dataPointThreshold:m,startTime:l.length>0?l[l.length-1].time:0,runningTime:c,skipFinal:h<a.length-1,tickStart:l.length>0?l[l.length-1].time+m*p:0}))).finalModifiers).totalPotatoes=i.totalPotatoes,o=i.plants,l=l.concat(i.dataPointsPotatoes),a[h].obj={text:"P".concat(a.length-h," for ").concat(a[h].time),numAutos:a[h].autos,time:a[h].time},c+=a[h].time}if(Math.abs(r.time-l[l.length-1])>100);for(var f=l[1].time,d=l[1].time,g=0;g<l.length;g++)if(g>0&&l[g].time+f<l[g-1].time)throw f=l[g-1].time+d,!0,new Error("oof");return i.dataPointsPotatoes=l,i.steps=a,i},calcAssemblyHP:function(t){var e=1;if((null===t||void 0===t?void 0:t.AssemblerCollection[0].BonusList[0].StartingLevel)<=(null===t||void 0===t?void 0:t.AssemblerCollection[0].Level)){var o=null===t||void 0===t?void 0:t.AssemblerCollection[0].BonusList[0].Gain,r=(null===t||void 0===t?void 0:t.AssemblerCollection[0].Level)-(null===t||void 0===t?void 0:t.AssemblerCollection[0].BonusList[0].StartingLevel);e=Math.pow(1+o,r)}return e},calcContagionBonus:function(t,e){var o=1;if(t.GrasshopperCollection[e].Locked>0){var r=s.calcPOW(t.GrasshopperCollection[e].BaseBonus),n=s.calcPOW(t.GrasshopperCollection[e].Level);o*=Math.pow(1+.01*r,n)}return o},calcExpeditionHP:function(t){var e=1;if(t.ExpeditionsCollection[16].Locked>0){var o=t.ExpeditionsCollection[16];e=Math.pow(1+o.BonusPower,o.Room-1)}return e},calcUniqueHPBonus:function(t){for(var e=1,o=0;o<t.FarmingShopUniqueHealthy.length;o++)e*=t.FarmingShopUniqueHealthy[o]+1;return e},calcFriesHPBonus:function(t){var e=1;return e*=1+s.calcPOW(t.FrenchFriesTotal)*((.01*t.FarmingShopFriesHealthyBonus+.1)*this.calcContagionBonus(t,5))},calcPetHPBonus:function(t){for(var e=1,o=t.EquipedPetID,r=t.PetsCollection,n={},a=0;a<o.length;a++)o[a]>0&&(n[o[a]]=!0);for(var i=0;i<r.length;i++){var l=r[i];if(l.ID in n){l.Rank;for(var c=0;c<l.BonusList.length;c++){var u=l.BonusList[c];if(23===u.ID){var p=Math.pow(1+u.Gain,l.Level)-1,m=s.calculateLogarithm(1.0125,l.Level+1);e+=.5*((p+Math.max(0,.5*(.005*m-1)))*(1+.005*s.calculateLogarithm(1.075,l.Rank+1)))}}}}return e},calcHPBonus:function(t){return s.calcPOW(t.HealthyPotatoBonus)}},c=l;self.onmessage=function(t){var e=t.data,o=e.data;e.id,e.data1;try{for(var r=o.finalPlants,a=o.modifiers,i=o.mode,s=o.time,l=o.numSimulatedAutos?o.numSimulatedAutos:1,u=o.combinations,p=0,m={},h=0,f={},d=0,g={potatoeProduction:0},v=0,P={potatoeProduction:0},b=n(n({},a),{},{time:3600*s}),S=[],w=[],y=o.start;y<=o.end;y++){var T=u[y];b.numAutos=T;var M=void 0;switch(i){case"afk":default:M=c.calcHPProd(r,b);break;case"step":var O=[],C=0,x=0,k=0;if(1===T[4]&&15===T[5]);for(var L=0;L<T.length;L++)T[L]>0&&(x++,k+=T[L]*o.baseTimers[L]);for(var E=3600*s-k,A=0;A<o.baseTimers.length;A++){T[A]>0&&C++;var N=Array(o.baseTimers.length).fill(0);N[A]=l,N.reverse();var H=T[A]*o.baseTimers[A];H,C===x&&T[A]>0&&(H+=E),O.push({time:H,autos:N})}try{M=c.calcStepHPProd(r,n(n({},b),{},{steps:O,numSteps:x}))}catch(q){console.log(q);continue}}for(var B=0,R=0,F=0;F<M.plants.length;F++){var I=c.calcMaxPrestige(M.plants[F]);B+=I,R+=Math.pow(1.02,M.plants[F].prestige+I)-Math.pow(1.02,M.plants[F].prestige),M.plants[F].picIncrease=I}if(M.totalPotatoes>=p&&(p=M.totalPotatoes,m={combo:T,result:M,plants:M.plants},S.unshift({data:M.dataPointsPotatoes,result:p}),S.length>10&&S.pop(),w.unshift({data:M.dataPointsFries,result:p}),w.length>10&&w.pop()),M.potatoeProduction>=h&&(h=M.potatoeProduction,f={combo:T,result:M,plants:M.plants}),B>d){var G={combo:T,result:M,plants:M.plants,potatoeProduction:M.potatoeProduction,picGain:B,picStats:{picLevel:B,picPercent:R}};d=B,g=G}else if(B===d&&M.potatoeProduction>g.potatoeProduction){var J={combo:T,result:M,plants:M.plants,potatoeProduction:M.potatoeProduction,picGain:B,picStats:{picLevel:B,picPercent:R}};d=B,g=J}if(R>v){var j={combo:T,result:M,plants:M.plants,potatoeProduction:M.potatoeProduction,picGain:R,picStats:{picLevel:B,picPercent:R}};v=R,P=j}else if(R===v&&M.potatoeProduction>P.potatoeProduction){var D={combo:T,result:M,plants:M.plants,potatoeProduction:M.potatoeProduction,picGain:R,picStats:{picLevel:B,picPercent:R}};v=R,P=D}self.postMessage({update:!0})}self.postMessage({success:!0,totalPotCombo:m,bestProdCombo:f,bestPicCombo:g,bestPICPercCombo:P,top10DataPointsPotatoes:S,top10DataPointsFries:w})}catch(q){console.log(q)}}}}]);
//# sourceMappingURL=133.32c6e9f3.chunk.js.map
"use strict";(self.webpackChunkfapi=self.webpackChunkfapi||[]).push([[359],{5359:function(t,e,o){var a=o(1413),r=o(3433),i={roundTwoDecimal:function(t){return Math.round(100*(t+Number.EPSILON))/100},roundThreeDecimal:function(t){return Math.round(1e3*(t+Number.EPSILON))/1e3},roundInt:function(t){return Math.round(1*(t+Number.EPSILON))/1},calculateLogarithm:function(t,e){return Math.log(e)/Math.log(t)},calcPOW:function(t){return t.mantissa*Math.pow(10,t.exponent)},secondsToStringWithS:function(t){var e,o,a,r="";return e=Math.floor(t/3600),o=Math.floor(t%3600/60),a=this.roundInt(t%3600%60),e>0&&(r+="".concat(e<10?"0"+e:e,"h:")),o>0&&(r+="".concat(o<10?"0"+o:o,"m:")),r+=a>0?"".concat(a<10?"0"+a:a,"s"):"0s"},secondsToString:function(t){var e,o,a="";return e=Math.floor(t/3600),o=this.roundInt(t%3600/60),e>0&&(a+="".concat(e<10?"0"+e:e,"h:")),a+=o>0?"".concat(o<10?"0"+o:o,"m"):"0s"},bonusColorMap:{1001:{color:"maroon"},1002:{color:"orange"},1003:{color:"purple"},1009:{color:"cyan"},1012:{color:"yellow"},1013:{color:"red"},1014:{color:"blue"},1015:{color:"gray"},1016:{color:"green"}}},n=o(9298),l={createDecimal:function(t){return t.mantissa||0===t.mantissa?new n.Z("".concat(t.mantissa,"e").concat(t.exponent)):new n.Z(t)},multiplyDecimal:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t)).times(e)},divideDecimal:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t)).dividedBy(e)},addDecimal:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t)).plus(e)},subtractDecimal:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t)).minus(e)},logDecimal:function(t,e){return t=t.mantissa||0===t.mantissa?t:this.createDecimal(t),this.createDecimal(t.log(e))},pow:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t)).pow(e)}},s={findMultipliersWithMinPercentage:function(t,e,o){var a=[],i=0;return function n(l,s,c){if(i++,l!==e.length)for(var u=Math.floor((t-s)/e[l]),p=0;p<=u;p++){c[l]=p,s+p*e[l]<t&&n(l+1,s+p*e[l],c)}else{var m=c.reduce((function(t,o,a){return t+o*e[a]}),0);m>=o*t&&a.push((0,r.Z)(c))}}(0,0,[]),console.log(i),a},calcGrowthTime:function(t,e){var o=Math.floor(t.TimeNeeded/t.prestigeBonus/(1+.05*e.shopGrowingSpeed)/e.petPlantCombo/e.contagionPlantGrowth);return o<10?10:o},calcPlantHarvest:function(t,e){return i.roundInt((1+t.Rank)*Math.pow(1.05,t.Rank))*Math.pow(1.02,t.prestige)*e.contagionHarvest},calcShopProdBonus:function(t,e){return e=e||t.FarmingShopPlantTotalProduction,l.pow(1.25,e)},calcProdOutput:function(t,e){var o=t.totalMade,a=(t.created,e.manualHarvestFormula,e.shopProdBonus),r=t.prestige,i=l.multiplyDecimal(l.multiplyDecimal(a,1),e.contagionPlantProd),n=t.futureMult,s=l.multiplyDecimal(l.multiplyDecimal(l.multiplyDecimal(o,n),i),l.createDecimal(Math.pow(1.02,r)));return 1===t.ID&&(s=l.multiplyDecimal(s,e.hpBonus)),s},calcFryOutput:function(t){var e=l.logDecimal(t,10),o=l.subtractDecimal(l.logDecimal(t,10),15.75),a=e;a=a.lessThan(31)?a:31;var r=l.subtractDecimal(l.createDecimal(36),a),i=l.pow(l.createDecimal(1.15),l.subtractDecimal(e,16));return l.multiplyDecimal(o,l.multiplyDecimal(r,i))},calcCarryOverEXP:function(t){var e=t.plant,o=t.numAutos,a=t.expTick,r=0,i=1;if(o>1){var n=a/o,l=Math.ceil((e.reqExp-e.curExp)/n);if(o>l){r=(o-l)*n;for(var s=10+5*(e.Rank+i)*Math.pow(1.05,e.Rank+i);r>s;)r-=s,i++,s=10+5*(e.Rank+i)*Math.pow(1.05,e.Rank+i)}else r=0}else r=0;return{leftOver:r,numLevels:i,reqExp:10+5*(e.Rank+i)*Math.pow(1.05,e.Rank+i)}},futureMultBD:function(t,e){return l.pow(1+.05*(1+.02*e.manualHarvestFormula),l.logDecimal(t.created,1.25))},calcFutureMult:function(t,e){var o=!1===e.string?t:JSON.parse(JSON.stringify(t)),a=!1===e.string?e:JSON.parse(JSON.stringify(e)),r=a.time,i=a.numAuto||0===(null===a||void 0===a?void 0:a.numAuto)?a.numAuto:1,n=o.prestigeBonus*a.expBonus*i;for(o.growthTime=Math.floor(o.TimeNeeded/o.prestigeBonus/(1+.05*a.shopGrowingSpeed)/a.petPlantCombo/a.contagionPlantGrowth),o.growthTime<10&&(o.growthTime=10);r>0;){o.timeToLevel=this.calcTimeTillLevel(o,a);var s=0,c=!1;o.timeToLevel>r?s=r:(s=o.timeToLevel,c=!0),r-=s,o.elapsedTime+=s;var u=0;if(o.elapsedTime>=o.growthTime){u=Math.floor(o.elapsedTime/o.growthTime);var p=o.perHarvest*u*i;if(o.created=l.addDecimal(o.created,p),o.totalMade=l.addDecimal(o.totalMade,p),o.futureMult=this.futureMultBD(o,a),c){var m=this.calcCarryOverEXP({plant:o,expTick:n,numAutos:i});o.curExp=m.leftOver,o.Rank+=m.numLevels,o.perHarvest=this.calcPlantHarvest(o,a),o.reqExp=m.reqExp}else{var d=u*n,h=o.curExp+d;o.curExp=h}o.elapsedTime=o.elapsedTime%o.growthTime}}var v=this.calcProdOutput(o,a);return o.production=v,o},calcTimeTillLevel:function(t,e){var o=t,a=e,r=a.numAuto||0===(null===a||void 0===a?void 0:a.numAuto)?a.numAuto:1,i=o.reqExp-o.curExp,n=o.prestigeBonus*a.expBonus*r;return Math.ceil(i/n)*o.growthTime-o.elapsedTime},getNextShopCosts:function(t){var e=t.FarmingShopPlantTotalProduction?t.FarmingShopPlantTotalProduction:t.shopProdLevel,o=t.FarmingShopPlantGrowingSpeed?t.FarmingShopPlantGrowingSpeed:t.shopGrowingSpeed,a=t.FarmingShopPlantRankExpEarned?t.FarmingShopPlantRankExpEarned:t.shopRankLevel,r=l.pow(1.05,e-50),i=l.multiplyDecimal(100,r),n=l.pow(i,e),s=l.multiplyDecimal(1e8,n);return{prodCost:e>50?s:l.multiplyDecimal(1e8,l.pow(100,e)),growthCost:1e10*Math.pow(500,o),expCost:1e15*Math.pow(250,a)}},calcMaxPrestige:function(t){for(var e=t.prestige,o=0,a=!0;a;){var r=o+10*Math.pow(2,e);t.created.greaterThanOrEqualTo(r)?(e++,o+=r):a=!1}return e-t.prestige},calcTimeTillPrestige:function(t,e){var o=JSON.parse(JSON.stringify(t));this.resetPlantBD(o);var a=JSON.parse(JSON.stringify(e));this.resetModifiersBD(a);for(var r=a.numAuto||0===(null===a||void 0===a?void 0:a.numAuto)?a.numAuto:1,i=!1,n=0,s=0,c=o.prestigeBonus*a.expBonus*r;!i;){var u=this.calcTimeTillLevel(o,a),p=s+10*Math.pow(2,o.prestige),m=p-o.created,d=Math.ceil(m/(o.perHarvest*r))*o.growthTime;if(d<=0)i=!0,n<=0&&(o.prestige++,i=!1,s+=p);else if(d>u){o.elapsedTime+=u;var h=Math.floor(o.elapsedTime/o.growthTime);o.created=l.addDecimal(o.created,h*o.perHarvest*r),o.totalMade=l.addDecimal(o.totalMade,h*o.perHarvest*r);var v=this.calcCarryOverEXP({plant:o,numAutos:r,expTick:c});o.Rank+=v.numLevels,o.curExp=v.leftOver,o.reqExp=v.reqExp,o.perHarvest=this.calcPlantHarvest(o,a),n+=u,o.elapsedTime=o.elapsedTime%o.growthTime}else{i=!0,o.elapsedTime+=d;var P=Math.floor(o.elapsedTime/o.growthTime);o.created=l.addDecimal(o.created,P*o.perHarvest*r),o.totalMade=l.addDecimal(o.totalMade,P*o.perHarvest*r),n+=d,o.elapsedTime=o.elapsedTime%o.growthTime}}return{remainingTime:n,prestige:o.prestige,prestiged:i}},resetPlantBD:function(t){var e,o,a,r,i,n;t.totalMade=null!==t&&void 0!==t&&null!==(e=t.totalMade)&&void 0!==e&&e.mantissa||0===(null===t||void 0===t||null===(o=t.totalMade)||void 0===o?void 0:o.mantissa)?t.totalMade:l.createDecimal(t.totalMade),t.created=null!==t&&void 0!==t&&null!==(a=t.created)&&void 0!==a&&a.mantissa||0===(null===t||void 0===t||null===(r=t.created)||void 0===r?void 0:r.mantissa)?t.created:l.createDecimal(t.created),t.production=null!==t&&void 0!==t&&null!==(i=t.production)&&void 0!==i&&i.mantissa||0===(null===t||void 0===t||null===(n=t.production)||void 0===n?void 0:n.mantissa)?t.production:l.createDecimal(t.production),t.futureMult=l.createDecimal(t.futureMult)},resetModifiersBD:function(t){var e,o,a,r,i,n,s;t.shopProdBonus=null!==t&&void 0!==t&&null!==(e=t.shopProdBonus)&&void 0!==e&&e.mantissa||0===(null===t||void 0===t||null===(o=t.shopProdBonus)||void 0===o?void 0:o.mantissa)?t.shopProdBonus:l.createDecimal(t.shopProdBonus),t.hpBonus=null!==t&&void 0!==t&&null!==(a=t.hpBonus)&&void 0!==a&&a.mantissa||0===(null===t||void 0===t||null===(r=t.hpBonus)||void 0===r?void 0:r.mantissa)?t.hpBonus:l.createDecimal(t.hpBonus),t.curPotatoes=null!==t&&void 0!==t&&null!==(i=t.curPotatoes)&&void 0!==i&&i.mantissa||0===(null===t||void 0===t?void 0:t.curPotatoes.mantissa)?t.curPotatoes:l.createDecimal(t.curPotatoes),t.totalPotatoes=null!==t&&void 0!==t&&null!==(n=t.totalPotatoes)&&void 0!==n&&n.mantissa||0===(null===t||void 0===t||null===(s=t.totalPotatoes)||void 0===s?void 0:s.mantissa)?t.totalPotatoes:l.createDecimal(t.totalPotatoes)},calcHPProd:function(t,e){for(var o=JSON.parse(JSON.stringify(t)),r=0;r<o.length;r++)this.resetPlantBD(o[r]);var n=JSON.parse(JSON.stringify(e));this.resetModifiersBD(n),n.nextCosts.prodCost=l.createDecimal(n.nextCosts.prodCost),n.nextCosts.growthCost=l.createDecimal(n.nextCosts.growthCost),n.nextCosts.expCost=l.createDecimal(n.nextCosts.expCost);for(var c=n.numAutos,u=n.time,p=n.startTime?n.startTime:0,m=n.runningTime?n.runningTime:0,d=n.maxSteps?n.maxSteps:100,h=n.tickStart?n.tickStart:0,v=n.tickRate?n.tickRate:60,P=n.dataPointThreshold?n.dataPointThreshold:u/v<d?1:i.roundInt(u/v/d),f=[],g=[],D=n.totalPotatoes,T=n.curPotatoes,M=Array(o.length).fill(0),S=0;S<o.length;S++)M[S]=o[S].production;for(var w=0,C=!1;w<u/v||C;w++){for(var x=o.length-1;x>=0;x--){var B=o[x],y=x===o.length-1?0:v>1?l.multiplyDecimal(l.addDecimal(M[x+1],o[x+1].production),.5*v):l.multiplyDecimal(o[x+1].production,v);B.totalMade=l.addDecimal(B.totalMade,y);var O=this.calcFutureMult(B,(0,a.Z)((0,a.Z)({},n),{},{time:v,numAuto:c[x],string:!1}));o[x]=O,M[x]=o[x].production}var b=i.roundInt(w*v+p);if(D=l.addDecimal(D,l.multiplyDecimal(o[0].production,v)),T=l.addDecimal(T,l.multiplyDecimal(o[0].production,v)),n.autoBuyPBC){var k=!1;if(!0===T.greaterThanOrEqualTo(n.nextCosts.prodCost)&&(T=l.subtractDecimal(T,n.nextCosts.prodCost),n.shopProdLevel++,n.shopProdBonus=this.calcShopProdBonus(n,n.shopProdLevel),k=!0),!0===T.greaterThanOrEqualTo(n.nextCosts.growthCost)&&(T=l.subtractDecimal(T,n.nextCosts.growthCost),n.shopGrowingSpeed++,k=!0),!0===T.greaterThanOrEqualTo(n.nextCosts.expCost)&&(T=l.subtractDecimal(T,n.nextCosts.expCost),n.shopRankLevel++,n.shopRankEXP=1+.1*n.shopRankLevel,k=!0),k){var L=this.getNextShopCosts(n);n.nextCosts=L}}if(w%P===0&&b>=h&&b<=u+m&&(f.push({time:b,production:D}),g.push({time:b,fries:s.calcFryOutput(D)})),!n.skipFinal){if(C&&b>=u+m)break;!C&&b<u+m&&(C=!0)}}if(w>0&&!n.skipFinal){var E=i.roundInt(w*v+p);if(0===f.length)f.push({time:E,production:D}),g.push({time:E,fries:s.calcFryOutput(D)});else if(f[f.length-1].production!==D&&E>u+m){var H=E-f[f.length-1].time,F=(D-f[f.length-1].production)/H,A=u+m-f[f.length-1].time,N=l.addDecimal(f[f.length-1].production,F*A),R={time:f[f.length-1].time+A,production:N};f.push(R),g.push({time:f[f.length-1].time+A,fries:s.calcFryOutput(N)}),D=N}}return{totalPotatoes:D,potatoeProduction:o[0].production,plants:o,nextCosts:n.nextCosts,dataPointsPotatoes:f,dataPointsFries:g,finalModifiers:n}},calcStepHPProd:function(t,e){for(var o=JSON.parse(JSON.stringify(t)),r=0;r<o.length;r++)this.resetPlantBD(o[r]);var n=JSON.parse(JSON.stringify(e));this.resetModifiersBD(n);for(var l=n.steps,s=-1,c=[],u=0,p=n.maxSteps?n.maxSteps:100,m=n.tickRate?n.tickRate:60,d=e.time/m<p?1:i.roundInt(e.time/m/p),h=0;h<l.length;h++)(n=(s=this.calcHPProd(o,(0,a.Z)((0,a.Z)({},n),{},{numAutos:l[h].autos,time:l[h].time,dataPointThreshold:d,startTime:c.length>0?c[c.length-1].time:0,runningTime:u,skipFinal:h<l.length-1,tickStart:c.length>0?c[c.length-1].time+d*m:0}))).finalModifiers).totalPotatoes=s.totalPotatoes,o=s.plants,c=c.concat(s.dataPointsPotatoes),l[h].obj={text:"P".concat(l.length-h," for ").concat(l[h].time),numAutos:l[h].autos,time:l[h].time},u+=l[h].time;return s.dataPointsPotatoes=c,s.steps=l,s},calcAssemblyHP:function(t){var e=1;if((null===t||void 0===t?void 0:t.AssemblerCollection[0].BonusList[0].StartingLevel)<=(null===t||void 0===t?void 0:t.AssemblerCollection[0].Level)){var o=null===t||void 0===t?void 0:t.AssemblerCollection[0].BonusList[0].Gain,a=(null===t||void 0===t?void 0:t.AssemblerCollection[0].Level)-(null===t||void 0===t?void 0:t.AssemblerCollection[0].BonusList[0].StartingLevel);e=Math.pow(1+o,a)}return e},calcContagionBonus:function(t,e){var o=1;if(t.GrasshopperCollection[e].Locked>0){var a=i.calcPOW(t.GrasshopperCollection[e].BaseBonus),r=i.calcPOW(t.GrasshopperCollection[e].Level);o*=Math.pow(1+.01*a,r)}return o},calcExpeditionHP:function(t){var e=1;if(t.ExpeditionsCollection[16].Locked>0){var o=t.ExpeditionsCollection[16];e=Math.pow(1+o.BonusPower,o.Room-1)}return e},calcUniqueHPBonus:function(t){for(var e=1,o=0;o<t.FarmingShopUniqueHealthy.length;o++)e*=t.FarmingShopUniqueHealthy[o]+1;return e},calcFriesHPBonus:function(t){var e=1;return e*=1+i.calcPOW(t.FrenchFriesTotal)*((.01*t.FarmingShopFriesHealthyBonus+.1)*this.calcContagionBonus(t,5))},calcPetHPBonus:function(t){for(var e=1,o=t.EquipedPetID,a=t.PetsCollection,r={},n=0;n<o.length;n++)o[n]>0&&(r[o[n]]=!0);for(var l=0;l<a.length;l++){var s=a[l];if(s.ID in r){s.Rank;for(var c=0;c<s.BonusList.length;c++){var u=s.BonusList[c];if(23===u.ID){var p=Math.pow(1+u.Gain,s.Level)-1,m=i.calculateLogarithm(1.0125,s.Level+1);e+=.5*((p+Math.max(0,.5*(.005*m-1)))*(1+.005*i.calculateLogarithm(1.075,s.Rank+1)))}}}}return e},calcHPBonus:function(t){return i.calcPOW(t.HealthyPotatoBonus)}},c=s;self.onmessage=function(t){var e=t.data,o=e.data;e.id,e.data1;try{for(var r=o.finalPlants,i=0;i<r.length;i++){var n=r[i];n.created=l.createDecimal(n.created),n.totalMade=l.createDecimal(n.totalMade),n.production=l.createDecimal(n.production)}var s=o.modifiers;s.shopProdBonus=l.createDecimal(s.shopProdBonus),s.hpBonus=l.createDecimal(s.hpBonus),s.curPotatoes=l.createDecimal(s.curPotatoes),s.totalPotatoes=l.createDecimal(s.totalPotatoes);for(var u=o.mode,p=o.time,m=o.numSimulatedAutos?o.numSimulatedAutos:1,d=o.combinations,h=l.createDecimal(0),v={},P=l.createDecimal(0),f={},g=0,D={potatoeProduction:0},T=0,M={potatoeProduction:0},S=(0,a.Z)((0,a.Z)({},s),{},{time:3600*p}),w=[],C=[],x=o.start;x<=o.end;x++){var B=d[x];S.numAutos=B;var y=void 0;switch(u){case"afk":default:y=c.calcHPProd(r,S);break;case"step":for(var O=[],b=0,k=0,L=0,E=0;E<B.length;E++)B[E]>0&&(k++,L+=B[E]*o.baseTimers[E]);for(var H=3600*p-L,F=0;F<o.baseTimers.length;F++){B[F]>0&&b++;var A=Array(o.baseTimers.length).fill(0);A[F]=m,A.reverse();var N=B[F]*o.baseTimers[F];N,b===k&&B[F]>0&&(N+=H),O.push({time:N,autos:A})}y=c.calcStepHPProd(r,(0,a.Z)((0,a.Z)({},S),{},{steps:O,numSteps:k}))}for(var R=0,q=0,G=0;G<y.plants.length;G++){var I=c.calcMaxPrestige(y.plants[G]);R+=I,q+=Math.pow(1.02,y.plants[G].prestige+I)-Math.pow(1.02,y.plants[G].prestige),y.plants[G].picIncrease=I}if(!0===y.totalPotatoes.greaterThanOrEqualTo(h)&&(h=y.totalPotatoes,v={combo:B,result:y,plants:y.plants},w.unshift({data:y.dataPointsPotatoes,result:h}),w.length>10&&w.pop(),C.unshift({data:y.dataPointsFries,result:h}),C.length>10&&C.pop()),!0===y.potatoeProduction.greaterThanOrEqualTo(P)&&(P=y.potatoeProduction,f={combo:B,result:y,plants:y.plants}),R>g){var J={combo:B,result:y,plants:y.plants,potatoeProduction:y.potatoeProduction,picGain:R,picStats:{picLevel:R,picPercent:q}};g=R,D=J}else if(R===g&&y.potatoeProduction.greaterThanOrEqualTo(D.potatoeProduction)){var Z={combo:B,result:y,plants:y.plants,potatoeProduction:y.potatoeProduction,picGain:R,picStats:{picLevel:R,picPercent:q}};g=R,D=Z}if(q>T){var W={combo:B,result:y,plants:y.plants,potatoeProduction:y.potatoeProduction,picGain:q,picStats:{picLevel:R,picPercent:q}};T=q,M=W}else if(q===T&&y.potatoeProduction.greaterThanOrEqualTo(M.potatoeProduction)){var X={combo:B,result:y,plants:y.plants,potatoeProduction:y.potatoeProduction,picGain:q,picStats:{picLevel:R,picPercent:q}};T=q,M=X}self.postMessage({update:!0})}self.postMessage({success:!0,totalPotCombo:v,bestProdCombo:f,bestPicCombo:D,bestPICPercCombo:M,top10DataPointsPotatoes:w,top10DataPointsFries:C})}catch(U){console.log(U)}}}}]);
//# sourceMappingURL=359.a668c23e.chunk.js.map